<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Live MT5 Prices</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .symbol { margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Live MT5 Prices</h1>
    <div id="prices">
        <!-- Prices will load here -->
    </div>

    <!-- TradingView GOLD chart widget -->
    <div class="tradingview-widget-container" style="margin-top: 30px;">
        <div id="tradingview_gold" style="height: 400px; width: 100%;"></div>
    </div>

    <!-- TradingView widget script -->
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script type="text/javascript">
      new TradingView.widget({
        "container_id": "tradingview_gold",
        "width": "100%",
        "height": 400,
        "symbol": "OANDA:XAUUSD",
        "interval": "60",  // 1-hour candles
        "timezone": "Etc/UTC",
        "theme": "dark",  // Set theme to dark for better black background
        "style": "1",
        "locale": "en",
        "toolbar_bg": "#1e1e1e",  // Dark toolbar background
        "enable_publishing": false,
        "hide_top_toolbar": false,
        "withdateranges": true,
        "allow_symbol_change": true,
        "details": true,
        "hotlist": true,
        "calendar": true,
        "studies": [
          "MASimple@tv-basicstudies"
        ],
        "overrides": {
          "paneProperties.background": "#000000",            // Black background
          "paneProperties.vertGridProperties.color": "#333333", // Dark grid lines vertical
          "paneProperties.horzGridProperties.color": "#333333", // Dark grid lines horizontal
          "mainSeriesProperties.candleStyle.upColor": "#FFD700",  // Bull candle yellow (gold)
          "mainSeriesProperties.candleStyle.downColor": "#FFFFFF", // Bear candle white
          "mainSeriesProperties.candleStyle.borderUpColor": "#FFD700",  // Bull candle border color same as fill
          "mainSeriesProperties.candleStyle.borderDownColor": "#FFFFFF", // Bear candle border color same as fill
          "mainSeriesProperties.candleStyle.wickUpColor": "#FFD700",  // Wick color for bull
          "mainSeriesProperties.candleStyle.wickDownColor": "#FFFFFF" // Wick color for bear
        }
      });
    </script>

    <script>
        async function fetchPrices() {
            const response = await fetch('/prices');
            const data = await response.json();

            let html = '';
            data.forEach(item => {
                html += `<div class="symbol"><strong>${item.symbol}</strong>: $${item.price}</div>`;
            });

            document.getElementById('prices').innerHTML = html;
        }

        fetchPrices();  // Initial load
        setInterval(fetchPrices, 500);  // Refresh every 0.5 sec
    </script>
</body>
</html>
